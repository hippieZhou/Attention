<prismMvvm:SessionStateAwarePage
    x:Class="Attention.App.Views.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:animations="using:Microsoft.Toolkit.Uwp.UI.Animations"
    xmlns:be="using:Attention.App.Behaviors"
    xmlns:behaviors="using:Microsoft.Toolkit.Uwp.UI.Animations.Behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ex="using:Attention.App.Extensions"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:ic="using:Microsoft.Xaml.Interactions.Core"
    xmlns:local="using:Attention.App.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:media="using:Microsoft.Toolkit.Uwp.UI.Media"
    xmlns:model="using:Attention.App.Models"
    xmlns:mtuc="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:prismMvvm="using:Prism.Windows.Mvvm"
    prismMvvm:ViewModelLocator.AutoWireViewModel="True"
    mc:Ignorable="d">

    <Grid>
        <i:Interaction.Behaviors>
            <ic:EventTriggerBehavior EventName="Loaded">
                <ic:InvokeCommandAction Command="{x:Bind ConcreteDataContext.LoadCommand, Mode=OneWay}" />
            </ic:EventTriggerBehavior>
        </i:Interaction.Behaviors>
        <mtuc:AdaptiveGridView
            Padding="8,0"
            animations:ReorderGridAnimation.Duration="250"
            DataFetchSize="1"
            DesiredWidth="420"
            IncrementalLoadingTrigger="Edge"
            IsItemClickEnabled="True"
            ItemHeight="280"
            ItemsSource="{x:Bind ConcreteDataContext.Wallpapers, Mode=OneWay}"
            OneRowModeEnabled="False"
            ScrollViewer.VerticalScrollBarVisibility="Auto"
            SelectionMode="Single">
            <mtuc:AdaptiveGridView.ItemContainerStyle>
                <Style BasedOn="{StaticResource BorderlessGridViewItem}" TargetType="GridViewItem">
                    <Setter Property="Margin" Value="6" />
                </Style>
            </mtuc:AdaptiveGridView.ItemContainerStyle>
            <mtuc:AdaptiveGridView.ItemTemplate>
                <DataTemplate x:DataType="model:WallpaperEntity">
                    <Grid Background="{x:Bind Background}">
                        <mtuc:ImageEx
                            x:Name="imageEx"
                            CacheMode="BitmapCache"
                            IsCacheEnabled="True"
                            Source="{x:Bind Thumbnail, Converter={StaticResource ImageSourceNullValueConverter}, ConverterParameter=ms-appx:///Assets/0b7a8b6a210ee4c0dc2dea8f36c44211e968cdbd.jpg}"
                            Stretch="UniformToFill" />

                        <TextBlock
                            Margin="12"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Bottom"
                            FontWeight="Medium"
                            Foreground="{ThemeResource ButtonForegroundPressed}"
                            Opacity="0"
                            RequestedTheme="Dark"
                            Text="{x:Bind CreateAt}">
                            <i:Interaction.Behaviors>
                                <behaviors:Fade
                                    x:Name="UserUp"
                                    AutomaticallyStart="True"
                                    Delay="0"
                                    EasingMode="EaseOut"
                                    EasingType="Linear"
                                    Value="1"
                                    Duration="400" />
                                <behaviors:Fade
                                    x:Name="UserDowm"
                                    AutomaticallyStart="True"
                                    Delay="0"
                                    EasingMode="EaseIn"
                                    EasingType="Linear"
                                    Value="0"
                                    Duration="400" />
                            </i:Interaction.Behaviors>
                        </TextBlock>

                        <i:Interaction.Behaviors>
                            <!--  鼠标相关操作  -->
                            <ic:EventTriggerBehavior EventName="PointerEntered">
                                <ic:CallMethodAction MethodName="StartAnimation" TargetObject="{Binding ElementName=UserUp}" />
                                <be:ElementScaleAction Entered="True" TargetObject="{Binding ElementName=imageEx}" />
                            </ic:EventTriggerBehavior>
                            <ic:EventTriggerBehavior EventName="PointerExited">
                                <ic:CallMethodAction MethodName="StartAnimation" TargetObject="{Binding ElementName=UserDowm}" />
                                <be:ElementScaleAction Entered="False" TargetObject="{Binding ElementName=imageEx}" />
                            </ic:EventTriggerBehavior>

                            <!--  单指相关操作  -->
                            <ic:EventTriggerBehavior EventName="PointerPressed">
                                <ic:CallMethodAction MethodName="StartAnimation" TargetObject="{Binding ElementName=UserUp}" />
                                <be:ElementScaleAction Entered="True" TargetObject="{Binding ElementName=imageEx}" />
                            </ic:EventTriggerBehavior>
                            <ic:EventTriggerBehavior EventName="PointerReleased">
                                <ic:CallMethodAction MethodName="StartAnimation" TargetObject="{Binding ElementName=UserDowm}" />
                                <be:ElementScaleAction Entered="False" TargetObject="{Binding ElementName=imageEx}" />
                            </ic:EventTriggerBehavior>
                            <ic:EventTriggerBehavior EventName="PointerCanceled">
                                <ic:CallMethodAction MethodName="StartAnimation" TargetObject="{Binding ElementName=UserDowm}" />
                                <be:ElementScaleAction Entered="False" TargetObject="{Binding ElementName=imageEx}" />
                            </ic:EventTriggerBehavior>
                        </i:Interaction.Behaviors>
                    </Grid>
                </DataTemplate>
            </mtuc:AdaptiveGridView.ItemTemplate>
        </mtuc:AdaptiveGridView>
    </Grid>
</prismMvvm:SessionStateAwarePage>
